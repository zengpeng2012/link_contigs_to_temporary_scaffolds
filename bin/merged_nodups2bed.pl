#!/usr/bin/perl
my $file=shift;
my $size=shift;
#0 new_ctg000116_np5512.40 1061 0 16 new_ctg000116_np5512.40 1342 0 42 91M1D59M TATGGCCAATACTAGGTATATAAGTAGTGATTTCAAATACAAAGGTTAATCATACCCTGGTAACTTTATGTAAGGCAGAGTTTGGGTTTTTGGGGGGGATAGTAGAAAAGTTGATAGATAAGTCACCCTTACTATCACTCTATAGAGTCA 13 77M73S CTATCACTCTATAGAGTCATACATGAGATTTTCACCACATACGGCTCCTCGTTCAATTATTTCAAAGTAATTAGATCGATCCTTTTTTAGTGTTTGAGTTATTTTCACTAATTGTGATATTTTTTTAGCCCTTTTAAAAGTATGAGTTGT CL100124396L2C001R012_512785 CL100124396L2C001R012_512785
#0 sca9_1216 109138 5 16 sca9_1216 109664 5 60 14S136M - 60 150M - F

open IN,$size or die $!;
while(<IN>){
	chomp;
	my @f=split;
	$id{$f[0]}=$f[1];
}
close IN;

#NC_022715.2	30852	31002	A00583:169:HLCTKDMXX:2:1101:32235:1047/1	60	-
#NC_022715.2	30830	30980	A00583:169:HLCTKDMXX:2:1101:32235:1047/2	60	+
#NC_022715.2	17643	17793	A00583:169:HLCTKDMXX:2:1101:20961:1094/1	60	-
#NC_022715.2	17453	17603	A00583:169:HLCTKDMXX:2:1101:20961:1094/2	60	+
#NC_022715.2	126009	126158	A00583:169:HLCTKDMXX:2:1101:28113:1110/1	60	-
my $le1=150;
my $le2=150;
open IN,$file or die $!;
while(<IN>){
	chomp;
	my @f=split;
	next if(($f[8]+$f[11])<1);
	next unless ($id{$f[1]});
	next unless ($id{$f[5]});
	my $strand1="+";
	my $strand2="+";
	if($f[0] ==16){
		$strand1="-";
	}
	
	if($f[4] == 16){
		$strand2="-";
	}

	if(($f[2]+$le1) > $id{$f[1]} || ($f[6]+$le2) > $id{$f[5]}){
		next;
	}
	print "$f[1]\t$f[2]\t",$f[2]+$le1,"\t$f[15]/1\t$f[8]\t$strand1\n";
	print "$f[5]\t$f[6]\t",$f[6]+$le2,"\t$f[15]/2\t$f[11]\t$strand2\n";
}

